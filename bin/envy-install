#!/usr/bin/env ruby

$LOAD_PATH.unshift File.expand_path("../lib", __dir__) # For use/testing when no gem is installed
require 'envy'

if ARGV.size == 1 && ARGV[0] == '--version'
  puts "installer for envy v#{Envy::VERSION}"
  exit 0
end

begin
  shell = Envy::HostShell
  installer = shell.installer.new
  if installer.detect_installed_envy?
    puts "It seems that you already have envy installed"
    puts "Do you want to reinstall it? (y/n)"
  end
  exit installer.run(ARGV.dup)
rescue Envy::Error => e
  STDERR.puts e.message
  exit 1
end
